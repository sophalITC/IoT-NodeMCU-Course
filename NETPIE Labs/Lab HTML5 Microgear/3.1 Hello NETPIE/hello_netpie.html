<script src="https://cdn.netpie.io/microgear.js"></script>

<script>
	const APPID = "YOUR APPID";	// AppID
	const KEY = "YOUR KEY";		// Key
	const SECRET = "YOUR SECRET";	// secret

	const ALIAS = "myhtml";			// ตั้งชื่ออุปกรณ์ เป็นอะไรก็ได้

	var microgear = Microgear.create({
		key: KEY,
		secret: SECRET,
		alias : ALIAS
	});
   
 	 // สร้างฟังก์ชั่นที่จะตอบสนองต่อ message ที่ เข้ามา
	microgear.on('message', function(topic,msg) {			
      	 //ในที่นี้ เราจะเอาข้อความไปแทนข้อความของ HTML element ชื่อ data
	    document.getElementById("data").innerHTML = msg;
	});

	  // สร้างฟังก์ชั่นที่จะถูกเรียกเมื่อ connect NETPIE สำเร็จ
	microgear.on('connected', function() {
	microgear.setAlias(ALIAS); 		// สามารถเปลี่ยน alias ได้

    	    // แสดงข่อความให้ทราบว่า connect สำเร็จ
		document.getElementById("data").innerHTML = "Now I am connected with netpie..."; 	
       
     	  // ตั้ง timer ให้ทำงานทุก 1 วินาที (1000 หมายถึง 1000 ms)
		setInterval(function() {

	// ส่งข้อความไปยังอุปกรณ์ชื่อตามตัวแปร ALIAS ซึ่งก็คือตัวเอง
		microgear.chat(ALIAS,"Hello from myself at "+Date.now());
		},1000);
	});

	microgear.connect(APPID);  // สร้างการเชื่อมต่อไปยัง NETPIE

</script>

<div id="data">_____</div>
